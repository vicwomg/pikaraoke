name: Manual Windows Build

on:
  workflow_dispatch:  # This enables the "Run workflow" button

jobs:
  build:
    runs-on: windows-latest

    steps:
    # 1. Check out your code
    - uses: actions/checkout@v4

    # 2. Set up Python
    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        cache: 'pip'

    # 3. Run your PowerShell Build Script
    # UPDATED: Now pointing to the script in the subdirectory
    - name: Build Installer
      shell: powershell
      run: |
        .\build_scripts\windows\build_windows_installer.ps1

    # 4. Upload as an Artifact (Instead of a Release)
    # The artifact path remains 'dist/...' because our script outputs to the project root
    - name: Upload Installer Artifact
      uses: actions/upload-artifact@v4
      with:
        name: PiKaraoke-Installer-Manual
        path: dist/installer/*.exe
        retention-days: 5 # Keeps the file for 5 days then deletes it